{{if .GoTags}}//go:build {{.GoTags}}
{{end}}// Autogenerated by goserpent; DO NOT EDIT.

#include <Python.h>

PyObject* PyIncRef(PyObject *o) {
	Py_INCREF(o);
	return o;
}

char *PyObjectToChar(PyObject *obj) {
    char *result = NULL;
    if (PyUnicode_Check(obj)) {
        PyObject *utf8_string = PyUnicode_AsUTF8String(obj);
        if (utf8_string != NULL) {
            result = PyBytes_AsString(utf8_string);
            Py_DECREF(utf8_string);
        }
    }
    return result;
}

{{range .Functions}}{{template "cpyexport" .}}{{end}}
static PyMethodDef GoModuleMethods[] = {
{{range .Functions}}	{{.PyModuleDef}},
{{end}}	{NULL, NULL, 0, NULL}
};

static struct PyModuleDef gomodule = {
	PyModuleDef_HEAD_INIT, "{{.CModuleName}}", NULL, -1, GoModuleMethods //
};

PyMODINIT_FUNC PyInit_{{.CModuleName}}(void) {
	return PyModule_Create(&gomodule);
}
